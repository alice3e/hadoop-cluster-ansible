---
- name: restart hadoop namenode
  become: yes
  become_user: "{{ ansible_user }}"
  shell: >
    . /etc/profile.d/hadoop.sh
    /usr/local/hadoop/bin/hdfs --daemon stop namenode
    /usr/local/hadoop/bin/hdfs --daemon start namenode
  args:
    executable: /bin/bash

- name: restart hadoop resourcemanager
  become: yes
  become_user: "{{ ansible_user }}"
  shell: >
    . /etc/profile.d/hadoop.sh
    /usr/local/hadoop/bin/yarn --daemon stop resourcemanager
    /usr/local/hadoop/bin/yarn --daemon start resourcemanager
  args:
    executable: /bin/bash

- name: restart hadoop historyserver
  become: yes
  become_user: "{{ ansible_user }}"
  shell: >
    . /etc/profile.d/hadoop.sh
    /usr/local/hadoop/bin/mapred --daemon stop historyserver
    /usr/local/hadoop/bin/mapred --daemon start historyserver
  args:
    executable: /bin/bash